# 爬取平台概要设计

## 一、引言
	
### 1. 编写目的

因为在近一年的积累，无论从数据量还是数据来源都尽量多的情况下，针对公司当前已有的抓取脚本做一个整合，做到抓取平台化，方便脚本的管理，同时搭建一个web服务，方便同事自由选取对数据抓取。

### 2. 范围

该平台涵盖包括有：

>景区部分：携程网、途牛网、同程网、去哪儿网、百度旅游、蚂蜂窝

>酒店部分：艺龙网、驴妈妈、途牛

>吃住行游购娱：大众点评、携程攻略

>地图数据：高德地图

>其他

### 3. 定义

爬虫，爬虫的目标是通过一切技术手段抓取数据的一个过程。通过Python来实现，而Python这门语言是一门动态语言，属于弱语言不需要经历编译即可直接运行。

- 从爬虫设计角度，一个优秀的爬虫需要具备的特征有：高性能、好的可扩展性、健壮性和友好性。

- 从用户体验角度考虑，对爬虫的工作效果评估标准包括：抓取网页覆盖率、抓取网页实时性和抓取网页重要性。

- 抓取策略、网页更新策略、暗网抓取和分布式策略是爬虫系统至关重要的4个方面内容，基本决定了爬虫系统的质量和性能。

### 4. 参考文档

1. 《这个就是搜索引擎:核心技术详解》
2. 《爬虫进阶》

## 二、总体设计

“抓取平台”项目的建设，将公司现有的脚本统一管理、统一标准，为后续的脚本提供一个良好的平台，同时提升效率

### 1.设计思路
1. 总体思路：
	
	采取模块化的方式，来完成该抓取平台

2. 模块：
	- 中间件模块
	- 后台控制模块
	- 调度器
	- 任务引擎
	- slave模块
	- 持久化引擎

### 2.设计原则

满足面相对象的原则，在项目建设与安防设计中，将遵循先进性、实用性、高可靠性、开放性、可维护性、可伸缩性、可移植性的原则。

### 3.系统架构

该系统架构入下图

![架构][1]

[1]:https://github.com/beforeuwait/spider_platform/blob/master/%E5%B9%B3%E5%8F%B0%E6%A1%86%E6%9E%B6.png?raw=true

### 4.需求规定

当前需求:

|#|期望|结果|
|:-:|:-:|:-:|
|1|抓取具体需求|数据|
|2|新需求添加|部署配置新脚本|
|3|脚本维护|持续可靠运行|

### 5.运行环境

当前开发环境: macOS + Python3.6.2

### 6.流程处理

1. 用户角度：通过选择自己需要的数据，并配置好抓取字段，该平台自动抓取数据

2.	调度器：作为该平台的调度系统，分析需求，发布需求，持续监控各个模块的状态并相应的处理

3. 任务引擎：集成了各个脚本的抓取逻辑，向中间件中发布任务

4. slave模块：从任务队列里获取任务，承担了发起请求获取html数据，同时解析数据，并放入持久化队列中。在列表抓取任务中，slave模块还将肩负起在不同slave间通信的任务，以确保列表数据的完全抓取

5. 持久化引擎：根据用户的需求，对数据进行清洗，同时按照指定的格式进行输出。

## 三、接口设计

### 1.各模块api接口

> RequestsModel的api:

![slave的框架][2]

[2]:https://raw.githubusercontent.com/beforeuwait/spider_platform/master/requestModel.jpg

## 四、运行设计

### 1.运行控制

## 系统数据结构设计
 